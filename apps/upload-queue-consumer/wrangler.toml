name = "upload-queue-consumer"
main = "src/index.ts"
compatibility_date = "2025-01-13"

# Queue Consumer Configuration
[[queues.consumers]]
queue = "parse-cv"
max_batch_size = 10
max_batch_timeout = 5
max_retries = 3
dead_letter_queue = "parse-cv-dlq"

# Queue Producer Binding for DLQ
[[queues.producers]]
binding = "PARSE_CV_DLQ"
queue = "parse-cv-dlq"

# Environment Variables (set these via wrangler secret put)
# MONGO_CONNECTION
# API_URL
# R2_BUCKET_NAME
# R2_ACCESS_KEY_ID
# R2_SECRET_ACCESS_KEY
# R2_ENDPOINT

# R2 Bucket binding (if you need direct R2 access)
[[r2_buckets]]
binding = "UPLOADS_BUCKET"
bucket_name = "dyno-job-uploads"  # Production bucket name
preview_bucket_name = "dev"  # Local dev bucket (or same as production if using remote)
remote = true  # Ignored when you deploy to production
